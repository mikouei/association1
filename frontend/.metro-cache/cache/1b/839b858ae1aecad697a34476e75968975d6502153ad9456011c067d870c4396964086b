{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":31,"index":180}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/context/PlatformAuthContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.PlatformAuthProvider = PlatformAuthProvider;\n  exports.usePlatformAuth = usePlatformAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _utilsApi = require(_dependencyMap[2], \"../utils/api\");\n  var api = _interopDefault(_utilsApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const PlatformAuthContext = /*#__PURE__*/(0, _react.createContext)(null);\n  function PlatformAuthProvider({\n    children\n  }) {\n    _s();\n    const [superAdmin, setSuperAdmin] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n    const checkAuth = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('platformToken');\n        if (token) {\n          api.default.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n          const response = await api.default.get('/platform/me');\n          setSuperAdmin(response.data);\n        }\n      } catch (error) {\n        console.log('Platform auth check failed:', error);\n        await AsyncStorage.default.removeItem('platformToken');\n      } finally {\n        setLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      const response = await api.default.post('/platform/login', {\n        email,\n        password\n      });\n      const {\n        token,\n        user\n      } = response.data;\n\n      // Nettoyer le token utilisateur normal pour Ã©viter les conflits\n      await AsyncStorage.default.removeItem('authToken');\n      await AsyncStorage.default.removeItem('user');\n      await AsyncStorage.default.removeItem('association');\n      await AsyncStorage.default.setItem('platformToken', token);\n      api.default.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setSuperAdmin(user);\n      return user;\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('platformToken');\n      delete api.default.defaults.headers.common['Authorization'];\n      setSuperAdmin(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(PlatformAuthContext.Provider, {\n      value: {\n        superAdmin,\n        loading,\n        login,\n        logout\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 5\n    }, this);\n  }\n  _s(PlatformAuthProvider, \"ZIFGspvWDjrN/MB+5QxpRwLsBhU=\");\n  _c = PlatformAuthProvider;\n  function usePlatformAuth() {\n    _s2();\n    const context = (0, _react.useContext)(PlatformAuthContext);\n    if (!context) {\n      throw new Error('usePlatformAuth must be used within a PlatformAuthProvider');\n    }\n    return context;\n  }\n  _s2(usePlatformAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"PlatformAuthProvider\");\n});","lineCount":99,"map":[[15,2,7,0,"exports"],[15,9,7,0],[15,10,7,0,"PlatformAuthProvider"],[15,30,7,0],[15,33,7,0,"PlatformAuthProvider"],[15,53,7,0],[16,2,60,0,"exports"],[16,9,60,0],[16,10,60,0,"usePlatformAuth"],[16,25,60,0],[16,28,60,0,"usePlatformAuth"],[16,43,60,0],[17,2,1,0],[17,6,1,0,"_react"],[17,12,1,0],[17,15,1,0,"require"],[17,22,1,0],[17,23,1,0,"_dependencyMap"],[17,37,1,0],[18,2,2,0],[18,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[18,42,2,0],[18,45,2,0,"require"],[18,52,2,0],[18,53,2,0,"_dependencyMap"],[18,67,2,0],[19,2,2,0],[19,6,2,0,"AsyncStorage"],[19,18,2,0],[19,21,2,0,"_interopDefault"],[19,36,2,0],[19,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,73,2,0],[20,2,3,0],[20,6,3,0,"_utilsApi"],[20,15,3,0],[20,18,3,0,"require"],[20,25,3,0],[20,26,3,0,"_dependencyMap"],[20,40,3,0],[21,2,3,0],[21,6,3,0,"api"],[21,9,3,0],[21,12,3,0,"_interopDefault"],[21,27,3,0],[21,28,3,0,"_utilsApi"],[21,37,3,0],[22,2,3,31],[22,6,3,31,"_reactJsxDevRuntime"],[22,25,3,31],[22,28,3,31,"require"],[22,35,3,31],[22,36,3,31,"_dependencyMap"],[22,50,3,31],[23,2,5,0],[23,8,5,6,"PlatformAuthContext"],[23,27,5,25],[23,43,5,28],[23,47,5,28,"createContext"],[23,53,5,41],[23,54,5,41,"createContext"],[23,67,5,41],[23,69,5,42],[23,73,5,46],[23,74,5,47],[24,2,7,7],[24,11,7,16,"PlatformAuthProvider"],[24,31,7,36,"PlatformAuthProvider"],[24,32,7,37],[25,4,7,39,"children"],[26,2,7,48],[26,3,7,49],[26,5,7,51],[27,4,7,51,"_s"],[27,6,7,51],[28,4,8,2],[28,10,8,8],[28,11,8,9,"superAdmin"],[28,21,8,19],[28,23,8,21,"setSuperAdmin"],[28,36,8,34],[28,37,8,35],[28,40,8,38],[28,44,8,38,"useState"],[28,50,8,46],[28,51,8,46,"useState"],[28,59,8,46],[28,61,8,47],[28,65,8,51],[28,66,8,52],[29,4,9,2],[29,10,9,8],[29,11,9,9,"loading"],[29,18,9,16],[29,20,9,18,"setLoading"],[29,30,9,28],[29,31,9,29],[29,34,9,32],[29,38,9,32,"useState"],[29,44,9,40],[29,45,9,40,"useState"],[29,53,9,40],[29,55,9,41],[29,59,9,45],[29,60,9,46],[30,4,11,2],[30,8,11,2,"useEffect"],[30,14,11,11],[30,15,11,11,"useEffect"],[30,24,11,11],[30,26,11,12],[30,32,11,18],[31,6,12,4,"checkAuth"],[31,15,12,13],[31,16,12,14],[31,17,12,15],[32,4,13,2],[32,5,13,3],[32,7,13,5],[32,9,13,7],[32,10,13,8],[33,4,15,2],[33,10,15,8,"checkAuth"],[33,19,15,17],[33,22,15,20],[33,28,15,20,"checkAuth"],[33,29,15,20],[33,34,15,32],[34,6,16,4],[34,10,16,8],[35,8,17,6],[35,14,17,12,"token"],[35,19,17,17],[35,22,17,20],[35,28,17,26,"AsyncStorage"],[35,40,17,38],[35,41,17,38,"default"],[35,48,17,38],[35,49,17,39,"getItem"],[35,56,17,46],[35,57,17,47],[35,72,17,62],[35,73,17,63],[36,8,18,6],[36,12,18,10,"token"],[36,17,18,15],[36,19,18,17],[37,10,19,8,"api"],[37,13,19,11],[37,14,19,11,"default"],[37,21,19,11],[37,22,19,12,"defaults"],[37,30,19,20],[37,31,19,21,"headers"],[37,38,19,28],[37,39,19,29,"common"],[37,45,19,35],[37,46,19,36],[37,61,19,51],[37,62,19,52],[37,65,19,55],[37,75,19,65,"token"],[37,80,19,70],[37,82,19,72],[38,10,20,8],[38,16,20,14,"response"],[38,24,20,22],[38,27,20,25],[38,33,20,31,"api"],[38,36,20,34],[38,37,20,34,"default"],[38,44,20,34],[38,45,20,35,"get"],[38,48,20,38],[38,49,20,39],[38,63,20,53],[38,64,20,54],[39,10,21,8,"setSuperAdmin"],[39,23,21,21],[39,24,21,22,"response"],[39,32,21,30],[39,33,21,31,"data"],[39,37,21,35],[39,38,21,36],[40,8,22,6],[41,6,23,4],[41,7,23,5],[41,8,23,6],[41,15,23,13,"error"],[41,20,23,18],[41,22,23,20],[42,8,24,6,"console"],[42,15,24,13],[42,16,24,14,"log"],[42,19,24,17],[42,20,24,18],[42,49,24,47],[42,51,24,49,"error"],[42,56,24,54],[42,57,24,55],[43,8,25,6],[43,14,25,12,"AsyncStorage"],[43,26,25,24],[43,27,25,24,"default"],[43,34,25,24],[43,35,25,25,"removeItem"],[43,45,25,35],[43,46,25,36],[43,61,25,51],[43,62,25,52],[44,6,26,4],[44,7,26,5],[44,16,26,14],[45,8,27,6,"setLoading"],[45,18,27,16],[45,19,27,17],[45,24,27,22],[45,25,27,23],[46,6,28,4],[47,4,29,2],[47,5,29,3],[48,4,31,2],[48,10,31,8,"login"],[48,15,31,13],[48,18,31,16],[48,24,31,16,"login"],[48,25,31,23,"email"],[48,30,31,28],[48,32,31,30,"password"],[48,40,31,38],[48,45,31,43],[49,6,32,4],[49,12,32,10,"response"],[49,20,32,18],[49,23,32,21],[49,29,32,27,"api"],[49,32,32,30],[49,33,32,30,"default"],[49,40,32,30],[49,41,32,31,"post"],[49,45,32,35],[49,46,32,36],[49,63,32,53],[49,65,32,55],[50,8,32,57,"email"],[50,13,32,62],[51,8,32,64,"password"],[52,6,32,73],[52,7,32,74],[52,8,32,75],[53,6,33,4],[53,12,33,10],[54,8,33,12,"token"],[54,13,33,17],[55,8,33,19,"user"],[56,6,33,24],[56,7,33,25],[56,10,33,28,"response"],[56,18,33,36],[56,19,33,37,"data"],[56,23,33,41],[58,6,35,4],[59,6,36,4],[59,12,36,10,"AsyncStorage"],[59,24,36,22],[59,25,36,22,"default"],[59,32,36,22],[59,33,36,23,"removeItem"],[59,43,36,33],[59,44,36,34],[59,55,36,45],[59,56,36,46],[60,6,37,4],[60,12,37,10,"AsyncStorage"],[60,24,37,22],[60,25,37,22,"default"],[60,32,37,22],[60,33,37,23,"removeItem"],[60,43,37,33],[60,44,37,34],[60,50,37,40],[60,51,37,41],[61,6,38,4],[61,12,38,10,"AsyncStorage"],[61,24,38,22],[61,25,38,22,"default"],[61,32,38,22],[61,33,38,23,"removeItem"],[61,43,38,33],[61,44,38,34],[61,57,38,47],[61,58,38,48],[62,6,40,4],[62,12,40,10,"AsyncStorage"],[62,24,40,22],[62,25,40,22,"default"],[62,32,40,22],[62,33,40,23,"setItem"],[62,40,40,30],[62,41,40,31],[62,56,40,46],[62,58,40,48,"token"],[62,63,40,53],[62,64,40,54],[63,6,41,4,"api"],[63,9,41,7],[63,10,41,7,"default"],[63,17,41,7],[63,18,41,8,"defaults"],[63,26,41,16],[63,27,41,17,"headers"],[63,34,41,24],[63,35,41,25,"common"],[63,41,41,31],[63,42,41,32],[63,57,41,47],[63,58,41,48],[63,61,41,51],[63,71,41,61,"token"],[63,76,41,66],[63,78,41,68],[64,6,42,4,"setSuperAdmin"],[64,19,42,17],[64,20,42,18,"user"],[64,24,42,22],[64,25,42,23],[65,6,44,4],[65,13,44,11,"user"],[65,17,44,15],[66,4,45,2],[66,5,45,3],[67,4,47,2],[67,10,47,8,"logout"],[67,16,47,14],[67,19,47,17],[67,25,47,17,"logout"],[67,26,47,17],[67,31,47,29],[68,6,48,4],[68,12,48,10,"AsyncStorage"],[68,24,48,22],[68,25,48,22,"default"],[68,32,48,22],[68,33,48,23,"removeItem"],[68,43,48,33],[68,44,48,34],[68,59,48,49],[68,60,48,50],[69,6,49,4],[69,13,49,11,"api"],[69,16,49,14],[69,17,49,14,"default"],[69,24,49,14],[69,25,49,15,"defaults"],[69,33,49,23],[69,34,49,24,"headers"],[69,41,49,31],[69,42,49,32,"common"],[69,48,49,38],[69,49,49,39],[69,64,49,54],[69,65,49,55],[70,6,50,4,"setSuperAdmin"],[70,19,50,17],[70,20,50,18],[70,24,50,22],[70,25,50,23],[71,4,51,2],[71,5,51,3],[72,4,53,2],[72,24,54,4],[72,28,54,4,"_reactJsxDevRuntime"],[72,47,54,4],[72,48,54,4,"jsxDEV"],[72,54,54,4],[72,56,54,5,"PlatformAuthContext"],[72,75,54,24],[72,76,54,25,"Provider"],[72,84,54,33],[73,6,54,34,"value"],[73,11,54,39],[73,13,54,41],[74,8,54,43,"superAdmin"],[74,18,54,53],[75,8,54,55,"loading"],[75,15,54,62],[76,8,54,64,"login"],[76,13,54,69],[77,8,54,71,"logout"],[78,6,54,78],[78,7,54,80],[79,6,54,80,"children"],[79,14,54,80],[79,16,55,7,"children"],[80,4,55,15],[81,6,55,15,"fileName"],[81,14,55,15],[81,16,55,15,"_jsxFileName"],[81,28,55,15],[82,6,55,15,"lineNumber"],[82,16,55,15],[83,6,55,15,"columnNumber"],[83,18,55,15],[84,4,55,15],[84,11,56,34],[84,12,56,35],[85,2,58,0],[86,2,58,1,"_s"],[86,4,58,1],[86,5,7,16,"PlatformAuthProvider"],[86,25,7,36],[87,2,7,36,"_c"],[87,4,7,36],[87,7,7,16,"PlatformAuthProvider"],[87,27,7,36],[88,2,60,7],[88,11,60,16,"usePlatformAuth"],[88,26,60,31,"usePlatformAuth"],[88,27,60,31],[88,29,60,34],[89,4,60,34,"_s2"],[89,7,60,34],[90,4,61,2],[90,10,61,8,"context"],[90,17,61,15],[90,20,61,18],[90,24,61,18,"useContext"],[90,30,61,28],[90,31,61,28,"useContext"],[90,41,61,28],[90,43,61,29,"PlatformAuthContext"],[90,62,61,48],[90,63,61,49],[91,4,62,2],[91,8,62,6],[91,9,62,7,"context"],[91,16,62,14],[91,18,62,16],[92,6,63,4],[92,12,63,10],[92,16,63,14,"Error"],[92,21,63,19],[92,22,63,20],[92,82,63,80],[92,83,63,81],[93,4,64,2],[94,4,65,2],[94,11,65,9,"context"],[94,18,65,16],[95,2,66,0],[96,2,66,1,"_s2"],[96,5,66,1],[96,6,60,16,"usePlatformAuth"],[96,21,60,31],[97,2,60,31],[97,6,60,31,"_c"],[97,8,60,31],[98,2,60,31,"$RefreshReg$"],[98,14,60,31],[98,15,60,31,"_c"],[98,17,60,31],[99,0,60,31],[99,3]],"functionMap":{"names":["<global>","PlatformAuthProvider","useEffect$argument_0","checkAuth","login","logout","usePlatformAuth"],"mappings":"AAA;OCM;YCI;GDE;oBEE;GFc;gBGE;GHc;iBIE;GJI;CDO;OME;CNM"},"hasCjsExports":false},"type":"js/module"}]}