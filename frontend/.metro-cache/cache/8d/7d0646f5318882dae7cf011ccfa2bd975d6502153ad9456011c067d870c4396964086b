{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":31,"index":180}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/context/PlatformAuthContext.js\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.PlatformAuthProvider = PlatformAuthProvider;\n  exports.usePlatformAuth = usePlatformAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _utilsApi = require(_dependencyMap[2], \"../utils/api\");\n  var api = _interopDefault(_utilsApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const PlatformAuthContext = /*#__PURE__*/(0, _react.createContext)(null);\n  function PlatformAuthProvider({\n    children\n  }) {\n    const [superAdmin, setSuperAdmin] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n    const checkAuth = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('platformToken');\n        if (token) {\n          api.default.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n          const response = await api.default.get('/platform/me');\n          setSuperAdmin(response.data);\n        }\n      } catch (error) {\n        console.log('Platform auth check failed:', error);\n        await AsyncStorage.default.removeItem('platformToken');\n      } finally {\n        setLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      const response = await api.default.post('/platform/login', {\n        email,\n        password\n      });\n      const {\n        token,\n        user\n      } = response.data;\n\n      // Nettoyer le token utilisateur normal pour Ã©viter les conflits\n      await AsyncStorage.default.removeItem('authToken');\n      await AsyncStorage.default.removeItem('user');\n      await AsyncStorage.default.removeItem('association');\n      await AsyncStorage.default.setItem('platformToken', token);\n      api.default.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setSuperAdmin(user);\n      return user;\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('platformToken');\n      delete api.default.defaults.headers.common['Authorization'];\n      setSuperAdmin(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(PlatformAuthContext.Provider, {\n      value: {\n        superAdmin,\n        loading,\n        login,\n        logout\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 5\n    }, this);\n  }\n  function usePlatformAuth() {\n    const context = (0, _react.useContext)(PlatformAuthContext);\n    if (!context) {\n      throw new Error('usePlatformAuth must be used within a PlatformAuthProvider');\n    }\n    return context;\n  }\n});","lineCount":90,"map":[[13,2,7,0,"exports"],[13,9,7,0],[13,10,7,0,"PlatformAuthProvider"],[13,30,7,0],[13,33,7,0,"PlatformAuthProvider"],[13,53,7,0],[14,2,60,0,"exports"],[14,9,60,0],[14,10,60,0,"usePlatformAuth"],[14,25,60,0],[14,28,60,0,"usePlatformAuth"],[14,43,60,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_utilsApi"],[18,15,3,0],[18,18,3,0,"require"],[18,25,3,0],[18,26,3,0,"_dependencyMap"],[18,40,3,0],[19,2,3,0],[19,6,3,0,"api"],[19,9,3,0],[19,12,3,0,"_interopDefault"],[19,27,3,0],[19,28,3,0,"_utilsApi"],[19,37,3,0],[20,2,3,31],[20,6,3,31,"_reactJsxDevRuntime"],[20,25,3,31],[20,28,3,31,"require"],[20,35,3,31],[20,36,3,31,"_dependencyMap"],[20,50,3,31],[21,2,5,0],[21,8,5,6,"PlatformAuthContext"],[21,27,5,25],[21,43,5,28],[21,47,5,28,"createContext"],[21,53,5,41],[21,54,5,41,"createContext"],[21,67,5,41],[21,69,5,42],[21,73,5,46],[21,74,5,47],[22,2,7,7],[22,11,7,16,"PlatformAuthProvider"],[22,31,7,36,"PlatformAuthProvider"],[22,32,7,37],[23,4,7,39,"children"],[24,2,7,48],[24,3,7,49],[24,5,7,51],[25,4,8,2],[25,10,8,8],[25,11,8,9,"superAdmin"],[25,21,8,19],[25,23,8,21,"setSuperAdmin"],[25,36,8,34],[25,37,8,35],[25,40,8,38],[25,44,8,38,"useState"],[25,50,8,46],[25,51,8,46,"useState"],[25,59,8,46],[25,61,8,47],[25,65,8,51],[25,66,8,52],[26,4,9,2],[26,10,9,8],[26,11,9,9,"loading"],[26,18,9,16],[26,20,9,18,"setLoading"],[26,30,9,28],[26,31,9,29],[26,34,9,32],[26,38,9,32,"useState"],[26,44,9,40],[26,45,9,40,"useState"],[26,53,9,40],[26,55,9,41],[26,59,9,45],[26,60,9,46],[27,4,11,2],[27,8,11,2,"useEffect"],[27,14,11,11],[27,15,11,11,"useEffect"],[27,24,11,11],[27,26,11,12],[27,32,11,18],[28,6,12,4,"checkAuth"],[28,15,12,13],[28,16,12,14],[28,17,12,15],[29,4,13,2],[29,5,13,3],[29,7,13,5],[29,9,13,7],[29,10,13,8],[30,4,15,2],[30,10,15,8,"checkAuth"],[30,19,15,17],[30,22,15,20],[30,28,15,20,"checkAuth"],[30,29,15,20],[30,34,15,32],[31,6,16,4],[31,10,16,8],[32,8,17,6],[32,14,17,12,"token"],[32,19,17,17],[32,22,17,20],[32,28,17,26,"AsyncStorage"],[32,40,17,38],[32,41,17,38,"default"],[32,48,17,38],[32,49,17,39,"getItem"],[32,56,17,46],[32,57,17,47],[32,72,17,62],[32,73,17,63],[33,8,18,6],[33,12,18,10,"token"],[33,17,18,15],[33,19,18,17],[34,10,19,8,"api"],[34,13,19,11],[34,14,19,11,"default"],[34,21,19,11],[34,22,19,12,"defaults"],[34,30,19,20],[34,31,19,21,"headers"],[34,38,19,28],[34,39,19,29,"common"],[34,45,19,35],[34,46,19,36],[34,61,19,51],[34,62,19,52],[34,65,19,55],[34,75,19,65,"token"],[34,80,19,70],[34,82,19,72],[35,10,20,8],[35,16,20,14,"response"],[35,24,20,22],[35,27,20,25],[35,33,20,31,"api"],[35,36,20,34],[35,37,20,34,"default"],[35,44,20,34],[35,45,20,35,"get"],[35,48,20,38],[35,49,20,39],[35,63,20,53],[35,64,20,54],[36,10,21,8,"setSuperAdmin"],[36,23,21,21],[36,24,21,22,"response"],[36,32,21,30],[36,33,21,31,"data"],[36,37,21,35],[36,38,21,36],[37,8,22,6],[38,6,23,4],[38,7,23,5],[38,8,23,6],[38,15,23,13,"error"],[38,20,23,18],[38,22,23,20],[39,8,24,6,"console"],[39,15,24,13],[39,16,24,14,"log"],[39,19,24,17],[39,20,24,18],[39,49,24,47],[39,51,24,49,"error"],[39,56,24,54],[39,57,24,55],[40,8,25,6],[40,14,25,12,"AsyncStorage"],[40,26,25,24],[40,27,25,24,"default"],[40,34,25,24],[40,35,25,25,"removeItem"],[40,45,25,35],[40,46,25,36],[40,61,25,51],[40,62,25,52],[41,6,26,4],[41,7,26,5],[41,16,26,14],[42,8,27,6,"setLoading"],[42,18,27,16],[42,19,27,17],[42,24,27,22],[42,25,27,23],[43,6,28,4],[44,4,29,2],[44,5,29,3],[45,4,31,2],[45,10,31,8,"login"],[45,15,31,13],[45,18,31,16],[45,24,31,16,"login"],[45,25,31,23,"email"],[45,30,31,28],[45,32,31,30,"password"],[45,40,31,38],[45,45,31,43],[46,6,32,4],[46,12,32,10,"response"],[46,20,32,18],[46,23,32,21],[46,29,32,27,"api"],[46,32,32,30],[46,33,32,30,"default"],[46,40,32,30],[46,41,32,31,"post"],[46,45,32,35],[46,46,32,36],[46,63,32,53],[46,65,32,55],[47,8,32,57,"email"],[47,13,32,62],[48,8,32,64,"password"],[49,6,32,73],[49,7,32,74],[49,8,32,75],[50,6,33,4],[50,12,33,10],[51,8,33,12,"token"],[51,13,33,17],[52,8,33,19,"user"],[53,6,33,24],[53,7,33,25],[53,10,33,28,"response"],[53,18,33,36],[53,19,33,37,"data"],[53,23,33,41],[55,6,35,4],[56,6,36,4],[56,12,36,10,"AsyncStorage"],[56,24,36,22],[56,25,36,22,"default"],[56,32,36,22],[56,33,36,23,"removeItem"],[56,43,36,33],[56,44,36,34],[56,55,36,45],[56,56,36,46],[57,6,37,4],[57,12,37,10,"AsyncStorage"],[57,24,37,22],[57,25,37,22,"default"],[57,32,37,22],[57,33,37,23,"removeItem"],[57,43,37,33],[57,44,37,34],[57,50,37,40],[57,51,37,41],[58,6,38,4],[58,12,38,10,"AsyncStorage"],[58,24,38,22],[58,25,38,22,"default"],[58,32,38,22],[58,33,38,23,"removeItem"],[58,43,38,33],[58,44,38,34],[58,57,38,47],[58,58,38,48],[59,6,40,4],[59,12,40,10,"AsyncStorage"],[59,24,40,22],[59,25,40,22,"default"],[59,32,40,22],[59,33,40,23,"setItem"],[59,40,40,30],[59,41,40,31],[59,56,40,46],[59,58,40,48,"token"],[59,63,40,53],[59,64,40,54],[60,6,41,4,"api"],[60,9,41,7],[60,10,41,7,"default"],[60,17,41,7],[60,18,41,8,"defaults"],[60,26,41,16],[60,27,41,17,"headers"],[60,34,41,24],[60,35,41,25,"common"],[60,41,41,31],[60,42,41,32],[60,57,41,47],[60,58,41,48],[60,61,41,51],[60,71,41,61,"token"],[60,76,41,66],[60,78,41,68],[61,6,42,4,"setSuperAdmin"],[61,19,42,17],[61,20,42,18,"user"],[61,24,42,22],[61,25,42,23],[62,6,44,4],[62,13,44,11,"user"],[62,17,44,15],[63,4,45,2],[63,5,45,3],[64,4,47,2],[64,10,47,8,"logout"],[64,16,47,14],[64,19,47,17],[64,25,47,17,"logout"],[64,26,47,17],[64,31,47,29],[65,6,48,4],[65,12,48,10,"AsyncStorage"],[65,24,48,22],[65,25,48,22,"default"],[65,32,48,22],[65,33,48,23,"removeItem"],[65,43,48,33],[65,44,48,34],[65,59,48,49],[65,60,48,50],[66,6,49,4],[66,13,49,11,"api"],[66,16,49,14],[66,17,49,14,"default"],[66,24,49,14],[66,25,49,15,"defaults"],[66,33,49,23],[66,34,49,24,"headers"],[66,41,49,31],[66,42,49,32,"common"],[66,48,49,38],[66,49,49,39],[66,64,49,54],[66,65,49,55],[67,6,50,4,"setSuperAdmin"],[67,19,50,17],[67,20,50,18],[67,24,50,22],[67,25,50,23],[68,4,51,2],[68,5,51,3],[69,4,53,2],[69,24,54,4],[69,28,54,4,"_reactJsxDevRuntime"],[69,47,54,4],[69,48,54,4,"jsxDEV"],[69,54,54,4],[69,56,54,5,"PlatformAuthContext"],[69,75,54,24],[69,76,54,25,"Provider"],[69,84,54,33],[70,6,54,34,"value"],[70,11,54,39],[70,13,54,41],[71,8,54,43,"superAdmin"],[71,18,54,53],[72,8,54,55,"loading"],[72,15,54,62],[73,8,54,64,"login"],[73,13,54,69],[74,8,54,71,"logout"],[75,6,54,78],[75,7,54,80],[76,6,54,80,"children"],[76,14,54,80],[76,16,55,7,"children"],[77,4,55,15],[78,6,55,15,"fileName"],[78,14,55,15],[78,16,55,15,"_jsxFileName"],[78,28,55,15],[79,6,55,15,"lineNumber"],[79,16,55,15],[80,6,55,15,"columnNumber"],[80,18,55,15],[81,4,55,15],[81,11,56,34],[81,12,56,35],[82,2,58,0],[83,2,60,7],[83,11,60,16,"usePlatformAuth"],[83,26,60,31,"usePlatformAuth"],[83,27,60,31],[83,29,60,34],[84,4,61,2],[84,10,61,8,"context"],[84,17,61,15],[84,20,61,18],[84,24,61,18,"useContext"],[84,30,61,28],[84,31,61,28,"useContext"],[84,41,61,28],[84,43,61,29,"PlatformAuthContext"],[84,62,61,48],[84,63,61,49],[85,4,62,2],[85,8,62,6],[85,9,62,7,"context"],[85,16,62,14],[85,18,62,16],[86,6,63,4],[86,12,63,10],[86,16,63,14,"Error"],[86,21,63,19],[86,22,63,20],[86,82,63,80],[86,83,63,81],[87,4,64,2],[88,4,65,2],[88,11,65,9,"context"],[88,18,65,16],[89,2,66,0],[90,0,66,1],[90,3]],"functionMap":{"names":["<global>","PlatformAuthProvider","useEffect$argument_0","checkAuth","login","logout","usePlatformAuth"],"mappings":"AAA;OCM;YCI;GDE;oBEE;GFc;gBGE;GHc;iBIE;GJI;CDO;OME;CNM"},"hasCjsExports":false},"type":"js/module"}]}