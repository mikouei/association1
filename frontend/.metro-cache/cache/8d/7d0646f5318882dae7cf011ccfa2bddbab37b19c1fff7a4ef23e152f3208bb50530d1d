{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":31,"index":180}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/context/PlatformAuthContext.js\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.PlatformAuthProvider = PlatformAuthProvider;\n  exports.usePlatformAuth = usePlatformAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _utilsApi = require(_dependencyMap[2], \"../utils/api\");\n  var api = _interopDefault(_utilsApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const PlatformAuthContext = /*#__PURE__*/(0, _react.createContext)(null);\n  function PlatformAuthProvider({\n    children\n  }) {\n    const [superAdmin, setSuperAdmin] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n    const checkAuth = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('platformToken');\n        if (token) {\n          // Utiliser le token directement dans la requête, pas dans les defaults\n          const response = await api.default.get('/platform/me', {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          setSuperAdmin(response.data);\n        }\n      } catch (error) {\n        console.log('Platform auth check failed:', error);\n        await AsyncStorage.default.removeItem('platformToken');\n      } finally {\n        setLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      const response = await api.default.post('/platform/login', {\n        email,\n        password\n      });\n      const {\n        token,\n        user\n      } = response.data;\n\n      // Nettoyer le token utilisateur normal pour éviter les conflits\n      await AsyncStorage.default.removeItem('authToken');\n      await AsyncStorage.default.removeItem('user');\n      await AsyncStorage.default.removeItem('association');\n      await AsyncStorage.default.setItem('platformToken', token);\n      // NE PAS utiliser api.defaults.headers - l'intercepteur gère les tokens via AsyncStorage\n      setSuperAdmin(user);\n      return user;\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('platformToken');\n      // Nettoyer aussi les defaults au cas où\n      delete api.default.defaults.headers.common['Authorization'];\n      setSuperAdmin(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(PlatformAuthContext.Provider, {\n      value: {\n        superAdmin,\n        loading,\n        login,\n        logout\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }, this);\n  }\n  function usePlatformAuth() {\n    const context = (0, _react.useContext)(PlatformAuthContext);\n    if (!context) {\n      throw new Error('usePlatformAuth must be used within a PlatformAuthProvider');\n    }\n    return context;\n  }\n});","lineCount":95,"map":[[13,2,7,0,"exports"],[13,9,7,0],[13,10,7,0,"PlatformAuthProvider"],[13,30,7,0],[13,33,7,0,"PlatformAuthProvider"],[13,53,7,0],[14,2,63,0,"exports"],[14,9,63,0],[14,10,63,0,"usePlatformAuth"],[14,25,63,0],[14,28,63,0,"usePlatformAuth"],[14,43,63,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_utilsApi"],[18,15,3,0],[18,18,3,0,"require"],[18,25,3,0],[18,26,3,0,"_dependencyMap"],[18,40,3,0],[19,2,3,0],[19,6,3,0,"api"],[19,9,3,0],[19,12,3,0,"_interopDefault"],[19,27,3,0],[19,28,3,0,"_utilsApi"],[19,37,3,0],[20,2,3,31],[20,6,3,31,"_reactJsxDevRuntime"],[20,25,3,31],[20,28,3,31,"require"],[20,35,3,31],[20,36,3,31,"_dependencyMap"],[20,50,3,31],[21,2,5,0],[21,8,5,6,"PlatformAuthContext"],[21,27,5,25],[21,43,5,28],[21,47,5,28,"createContext"],[21,53,5,41],[21,54,5,41,"createContext"],[21,67,5,41],[21,69,5,42],[21,73,5,46],[21,74,5,47],[22,2,7,7],[22,11,7,16,"PlatformAuthProvider"],[22,31,7,36,"PlatformAuthProvider"],[22,32,7,37],[23,4,7,39,"children"],[24,2,7,48],[24,3,7,49],[24,5,7,51],[25,4,8,2],[25,10,8,8],[25,11,8,9,"superAdmin"],[25,21,8,19],[25,23,8,21,"setSuperAdmin"],[25,36,8,34],[25,37,8,35],[25,40,8,38],[25,44,8,38,"useState"],[25,50,8,46],[25,51,8,46,"useState"],[25,59,8,46],[25,61,8,47],[25,65,8,51],[25,66,8,52],[26,4,9,2],[26,10,9,8],[26,11,9,9,"loading"],[26,18,9,16],[26,20,9,18,"setLoading"],[26,30,9,28],[26,31,9,29],[26,34,9,32],[26,38,9,32,"useState"],[26,44,9,40],[26,45,9,40,"useState"],[26,53,9,40],[26,55,9,41],[26,59,9,45],[26,60,9,46],[27,4,11,2],[27,8,11,2,"useEffect"],[27,14,11,11],[27,15,11,11,"useEffect"],[27,24,11,11],[27,26,11,12],[27,32,11,18],[28,6,12,4,"checkAuth"],[28,15,12,13],[28,16,12,14],[28,17,12,15],[29,4,13,2],[29,5,13,3],[29,7,13,5],[29,9,13,7],[29,10,13,8],[30,4,15,2],[30,10,15,8,"checkAuth"],[30,19,15,17],[30,22,15,20],[30,28,15,20,"checkAuth"],[30,29,15,20],[30,34,15,32],[31,6,16,4],[31,10,16,8],[32,8,17,6],[32,14,17,12,"token"],[32,19,17,17],[32,22,17,20],[32,28,17,26,"AsyncStorage"],[32,40,17,38],[32,41,17,38,"default"],[32,48,17,38],[32,49,17,39,"getItem"],[32,56,17,46],[32,57,17,47],[32,72,17,62],[32,73,17,63],[33,8,18,6],[33,12,18,10,"token"],[33,17,18,15],[33,19,18,17],[34,10,19,8],[35,10,20,8],[35,16,20,14,"response"],[35,24,20,22],[35,27,20,25],[35,33,20,31,"api"],[35,36,20,34],[35,37,20,34,"default"],[35,44,20,34],[35,45,20,35,"get"],[35,48,20,38],[35,49,20,39],[35,63,20,53],[35,65,20,55],[36,12,21,10,"headers"],[36,19,21,17],[36,21,21,19],[37,14,21,21,"Authorization"],[37,27,21,34],[37,29,21,36],[37,39,21,46,"token"],[37,44,21,51],[38,12,21,54],[39,10,22,8],[39,11,22,9],[39,12,22,10],[40,10,23,8,"setSuperAdmin"],[40,23,23,21],[40,24,23,22,"response"],[40,32,23,30],[40,33,23,31,"data"],[40,37,23,35],[40,38,23,36],[41,8,24,6],[42,6,25,4],[42,7,25,5],[42,8,25,6],[42,15,25,13,"error"],[42,20,25,18],[42,22,25,20],[43,8,26,6,"console"],[43,15,26,13],[43,16,26,14,"log"],[43,19,26,17],[43,20,26,18],[43,49,26,47],[43,51,26,49,"error"],[43,56,26,54],[43,57,26,55],[44,8,27,6],[44,14,27,12,"AsyncStorage"],[44,26,27,24],[44,27,27,24,"default"],[44,34,27,24],[44,35,27,25,"removeItem"],[44,45,27,35],[44,46,27,36],[44,61,27,51],[44,62,27,52],[45,6,28,4],[45,7,28,5],[45,16,28,14],[46,8,29,6,"setLoading"],[46,18,29,16],[46,19,29,17],[46,24,29,22],[46,25,29,23],[47,6,30,4],[48,4,31,2],[48,5,31,3],[49,4,33,2],[49,10,33,8,"login"],[49,15,33,13],[49,18,33,16],[49,24,33,16,"login"],[49,25,33,23,"email"],[49,30,33,28],[49,32,33,30,"password"],[49,40,33,38],[49,45,33,43],[50,6,34,4],[50,12,34,10,"response"],[50,20,34,18],[50,23,34,21],[50,29,34,27,"api"],[50,32,34,30],[50,33,34,30,"default"],[50,40,34,30],[50,41,34,31,"post"],[50,45,34,35],[50,46,34,36],[50,63,34,53],[50,65,34,55],[51,8,34,57,"email"],[51,13,34,62],[52,8,34,64,"password"],[53,6,34,73],[53,7,34,74],[53,8,34,75],[54,6,35,4],[54,12,35,10],[55,8,35,12,"token"],[55,13,35,17],[56,8,35,19,"user"],[57,6,35,24],[57,7,35,25],[57,10,35,28,"response"],[57,18,35,36],[57,19,35,37,"data"],[57,23,35,41],[59,6,37,4],[60,6,38,4],[60,12,38,10,"AsyncStorage"],[60,24,38,22],[60,25,38,22,"default"],[60,32,38,22],[60,33,38,23,"removeItem"],[60,43,38,33],[60,44,38,34],[60,55,38,45],[60,56,38,46],[61,6,39,4],[61,12,39,10,"AsyncStorage"],[61,24,39,22],[61,25,39,22,"default"],[61,32,39,22],[61,33,39,23,"removeItem"],[61,43,39,33],[61,44,39,34],[61,50,39,40],[61,51,39,41],[62,6,40,4],[62,12,40,10,"AsyncStorage"],[62,24,40,22],[62,25,40,22,"default"],[62,32,40,22],[62,33,40,23,"removeItem"],[62,43,40,33],[62,44,40,34],[62,57,40,47],[62,58,40,48],[63,6,42,4],[63,12,42,10,"AsyncStorage"],[63,24,42,22],[63,25,42,22,"default"],[63,32,42,22],[63,33,42,23,"setItem"],[63,40,42,30],[63,41,42,31],[63,56,42,46],[63,58,42,48,"token"],[63,63,42,53],[63,64,42,54],[64,6,43,4],[65,6,44,4,"setSuperAdmin"],[65,19,44,17],[65,20,44,18,"user"],[65,24,44,22],[65,25,44,23],[66,6,46,4],[66,13,46,11,"user"],[66,17,46,15],[67,4,47,2],[67,5,47,3],[68,4,49,2],[68,10,49,8,"logout"],[68,16,49,14],[68,19,49,17],[68,25,49,17,"logout"],[68,26,49,17],[68,31,49,29],[69,6,50,4],[69,12,50,10,"AsyncStorage"],[69,24,50,22],[69,25,50,22,"default"],[69,32,50,22],[69,33,50,23,"removeItem"],[69,43,50,33],[69,44,50,34],[69,59,50,49],[69,60,50,50],[70,6,51,4],[71,6,52,4],[71,13,52,11,"api"],[71,16,52,14],[71,17,52,14,"default"],[71,24,52,14],[71,25,52,15,"defaults"],[71,33,52,23],[71,34,52,24,"headers"],[71,41,52,31],[71,42,52,32,"common"],[71,48,52,38],[71,49,52,39],[71,64,52,54],[71,65,52,55],[72,6,53,4,"setSuperAdmin"],[72,19,53,17],[72,20,53,18],[72,24,53,22],[72,25,53,23],[73,4,54,2],[73,5,54,3],[74,4,56,2],[74,24,57,4],[74,28,57,4,"_reactJsxDevRuntime"],[74,47,57,4],[74,48,57,4,"jsxDEV"],[74,54,57,4],[74,56,57,5,"PlatformAuthContext"],[74,75,57,24],[74,76,57,25,"Provider"],[74,84,57,33],[75,6,57,34,"value"],[75,11,57,39],[75,13,57,41],[76,8,57,43,"superAdmin"],[76,18,57,53],[77,8,57,55,"loading"],[77,15,57,62],[78,8,57,64,"login"],[78,13,57,69],[79,8,57,71,"logout"],[80,6,57,78],[80,7,57,80],[81,6,57,80,"children"],[81,14,57,80],[81,16,58,7,"children"],[82,4,58,15],[83,6,58,15,"fileName"],[83,14,58,15],[83,16,58,15,"_jsxFileName"],[83,28,58,15],[84,6,58,15,"lineNumber"],[84,16,58,15],[85,6,58,15,"columnNumber"],[85,18,58,15],[86,4,58,15],[86,11,59,34],[86,12,59,35],[87,2,61,0],[88,2,63,7],[88,11,63,16,"usePlatformAuth"],[88,26,63,31,"usePlatformAuth"],[88,27,63,31],[88,29,63,34],[89,4,64,2],[89,10,64,8,"context"],[89,17,64,15],[89,20,64,18],[89,24,64,18,"useContext"],[89,30,64,28],[89,31,64,28,"useContext"],[89,41,64,28],[89,43,64,29,"PlatformAuthContext"],[89,62,64,48],[89,63,64,49],[90,4,65,2],[90,8,65,6],[90,9,65,7,"context"],[90,16,65,14],[90,18,65,16],[91,6,66,4],[91,12,66,10],[91,16,66,14,"Error"],[91,21,66,19],[91,22,66,20],[91,82,66,80],[91,83,66,81],[92,4,67,2],[93,4,68,2],[93,11,68,9,"context"],[93,18,68,16],[94,2,69,0],[95,0,69,1],[95,3]],"functionMap":{"names":["<global>","PlatformAuthProvider","useEffect$argument_0","checkAuth","login","logout","usePlatformAuth"],"mappings":"AAA;OCM;YCI;GDE;oBEE;GFgB;gBGE;GHc;iBIE;GJK;CDO;OME;CNM"},"hasCjsExports":false},"type":"js/module"}]}