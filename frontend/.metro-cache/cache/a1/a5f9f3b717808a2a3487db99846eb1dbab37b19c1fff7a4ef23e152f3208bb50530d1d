{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":31,"index":180}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/context/PlatformAuthContext.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.PlatformAuthProvider = PlatformAuthProvider;\n  exports.usePlatformAuth = usePlatformAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _utilsApi = require(_dependencyMap[2], \"../utils/api\");\n  var api = _interopDefault(_utilsApi);\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const PlatformAuthContext = /*#__PURE__*/(0, _react.createContext)(null);\n  function PlatformAuthProvider({\n    children\n  }) {\n    _s();\n    const [superAdmin, setSuperAdmin] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n    const checkAuth = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('platformToken');\n        if (token) {\n          // Utiliser le token directement dans la requête, pas dans les defaults\n          const response = await api.default.get('/platform/me', {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          setSuperAdmin(response.data);\n        }\n      } catch (error) {\n        console.log('Platform auth check failed:', error);\n        await AsyncStorage.default.removeItem('platformToken');\n      } finally {\n        setLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      const response = await api.default.post('/platform/login', {\n        email,\n        password\n      });\n      const {\n        token,\n        user\n      } = response.data;\n\n      // Nettoyer le token utilisateur normal pour éviter les conflits\n      await AsyncStorage.default.removeItem('authToken');\n      await AsyncStorage.default.removeItem('user');\n      await AsyncStorage.default.removeItem('association');\n      await AsyncStorage.default.setItem('platformToken', token);\n      // NE PAS utiliser api.defaults.headers - l'intercepteur gère les tokens via AsyncStorage\n      setSuperAdmin(user);\n      return user;\n    };\n    const logout = async () => {\n      await AsyncStorage.default.removeItem('platformToken');\n      // Nettoyer aussi les defaults au cas où\n      delete api.default.defaults.headers.common['Authorization'];\n      setSuperAdmin(null);\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(PlatformAuthContext.Provider, {\n      value: {\n        superAdmin,\n        loading,\n        login,\n        logout\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }, this);\n  }\n  _s(PlatformAuthProvider, \"ZIFGspvWDjrN/MB+5QxpRwLsBhU=\");\n  _c = PlatformAuthProvider;\n  function usePlatformAuth() {\n    _s2();\n    const context = (0, _react.useContext)(PlatformAuthContext);\n    if (!context) {\n      throw new Error('usePlatformAuth must be used within a PlatformAuthProvider');\n    }\n    return context;\n  }\n  _s2(usePlatformAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"PlatformAuthProvider\");\n});","lineCount":104,"map":[[15,2,7,0,"exports"],[15,9,7,0],[15,10,7,0,"PlatformAuthProvider"],[15,30,7,0],[15,33,7,0,"PlatformAuthProvider"],[15,53,7,0],[16,2,63,0,"exports"],[16,9,63,0],[16,10,63,0,"usePlatformAuth"],[16,25,63,0],[16,28,63,0,"usePlatformAuth"],[16,43,63,0],[17,2,1,0],[17,6,1,0,"_react"],[17,12,1,0],[17,15,1,0,"require"],[17,22,1,0],[17,23,1,0,"_dependencyMap"],[17,37,1,0],[18,2,2,0],[18,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[18,42,2,0],[18,45,2,0,"require"],[18,52,2,0],[18,53,2,0,"_dependencyMap"],[18,67,2,0],[19,2,2,0],[19,6,2,0,"AsyncStorage"],[19,18,2,0],[19,21,2,0,"_interopDefault"],[19,36,2,0],[19,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,73,2,0],[20,2,3,0],[20,6,3,0,"_utilsApi"],[20,15,3,0],[20,18,3,0,"require"],[20,25,3,0],[20,26,3,0,"_dependencyMap"],[20,40,3,0],[21,2,3,0],[21,6,3,0,"api"],[21,9,3,0],[21,12,3,0,"_interopDefault"],[21,27,3,0],[21,28,3,0,"_utilsApi"],[21,37,3,0],[22,2,3,31],[22,6,3,31,"_reactJsxDevRuntime"],[22,25,3,31],[22,28,3,31,"require"],[22,35,3,31],[22,36,3,31,"_dependencyMap"],[22,50,3,31],[23,2,5,0],[23,8,5,6,"PlatformAuthContext"],[23,27,5,25],[23,43,5,28],[23,47,5,28,"createContext"],[23,53,5,41],[23,54,5,41,"createContext"],[23,67,5,41],[23,69,5,42],[23,73,5,46],[23,74,5,47],[24,2,7,7],[24,11,7,16,"PlatformAuthProvider"],[24,31,7,36,"PlatformAuthProvider"],[24,32,7,37],[25,4,7,39,"children"],[26,2,7,48],[26,3,7,49],[26,5,7,51],[27,4,7,51,"_s"],[27,6,7,51],[28,4,8,2],[28,10,8,8],[28,11,8,9,"superAdmin"],[28,21,8,19],[28,23,8,21,"setSuperAdmin"],[28,36,8,34],[28,37,8,35],[28,40,8,38],[28,44,8,38,"useState"],[28,50,8,46],[28,51,8,46,"useState"],[28,59,8,46],[28,61,8,47],[28,65,8,51],[28,66,8,52],[29,4,9,2],[29,10,9,8],[29,11,9,9,"loading"],[29,18,9,16],[29,20,9,18,"setLoading"],[29,30,9,28],[29,31,9,29],[29,34,9,32],[29,38,9,32,"useState"],[29,44,9,40],[29,45,9,40,"useState"],[29,53,9,40],[29,55,9,41],[29,59,9,45],[29,60,9,46],[30,4,11,2],[30,8,11,2,"useEffect"],[30,14,11,11],[30,15,11,11,"useEffect"],[30,24,11,11],[30,26,11,12],[30,32,11,18],[31,6,12,4,"checkAuth"],[31,15,12,13],[31,16,12,14],[31,17,12,15],[32,4,13,2],[32,5,13,3],[32,7,13,5],[32,9,13,7],[32,10,13,8],[33,4,15,2],[33,10,15,8,"checkAuth"],[33,19,15,17],[33,22,15,20],[33,28,15,20,"checkAuth"],[33,29,15,20],[33,34,15,32],[34,6,16,4],[34,10,16,8],[35,8,17,6],[35,14,17,12,"token"],[35,19,17,17],[35,22,17,20],[35,28,17,26,"AsyncStorage"],[35,40,17,38],[35,41,17,38,"default"],[35,48,17,38],[35,49,17,39,"getItem"],[35,56,17,46],[35,57,17,47],[35,72,17,62],[35,73,17,63],[36,8,18,6],[36,12,18,10,"token"],[36,17,18,15],[36,19,18,17],[37,10,19,8],[38,10,20,8],[38,16,20,14,"response"],[38,24,20,22],[38,27,20,25],[38,33,20,31,"api"],[38,36,20,34],[38,37,20,34,"default"],[38,44,20,34],[38,45,20,35,"get"],[38,48,20,38],[38,49,20,39],[38,63,20,53],[38,65,20,55],[39,12,21,10,"headers"],[39,19,21,17],[39,21,21,19],[40,14,21,21,"Authorization"],[40,27,21,34],[40,29,21,36],[40,39,21,46,"token"],[40,44,21,51],[41,12,21,54],[42,10,22,8],[42,11,22,9],[42,12,22,10],[43,10,23,8,"setSuperAdmin"],[43,23,23,21],[43,24,23,22,"response"],[43,32,23,30],[43,33,23,31,"data"],[43,37,23,35],[43,38,23,36],[44,8,24,6],[45,6,25,4],[45,7,25,5],[45,8,25,6],[45,15,25,13,"error"],[45,20,25,18],[45,22,25,20],[46,8,26,6,"console"],[46,15,26,13],[46,16,26,14,"log"],[46,19,26,17],[46,20,26,18],[46,49,26,47],[46,51,26,49,"error"],[46,56,26,54],[46,57,26,55],[47,8,27,6],[47,14,27,12,"AsyncStorage"],[47,26,27,24],[47,27,27,24,"default"],[47,34,27,24],[47,35,27,25,"removeItem"],[47,45,27,35],[47,46,27,36],[47,61,27,51],[47,62,27,52],[48,6,28,4],[48,7,28,5],[48,16,28,14],[49,8,29,6,"setLoading"],[49,18,29,16],[49,19,29,17],[49,24,29,22],[49,25,29,23],[50,6,30,4],[51,4,31,2],[51,5,31,3],[52,4,33,2],[52,10,33,8,"login"],[52,15,33,13],[52,18,33,16],[52,24,33,16,"login"],[52,25,33,23,"email"],[52,30,33,28],[52,32,33,30,"password"],[52,40,33,38],[52,45,33,43],[53,6,34,4],[53,12,34,10,"response"],[53,20,34,18],[53,23,34,21],[53,29,34,27,"api"],[53,32,34,30],[53,33,34,30,"default"],[53,40,34,30],[53,41,34,31,"post"],[53,45,34,35],[53,46,34,36],[53,63,34,53],[53,65,34,55],[54,8,34,57,"email"],[54,13,34,62],[55,8,34,64,"password"],[56,6,34,73],[56,7,34,74],[56,8,34,75],[57,6,35,4],[57,12,35,10],[58,8,35,12,"token"],[58,13,35,17],[59,8,35,19,"user"],[60,6,35,24],[60,7,35,25],[60,10,35,28,"response"],[60,18,35,36],[60,19,35,37,"data"],[60,23,35,41],[62,6,37,4],[63,6,38,4],[63,12,38,10,"AsyncStorage"],[63,24,38,22],[63,25,38,22,"default"],[63,32,38,22],[63,33,38,23,"removeItem"],[63,43,38,33],[63,44,38,34],[63,55,38,45],[63,56,38,46],[64,6,39,4],[64,12,39,10,"AsyncStorage"],[64,24,39,22],[64,25,39,22,"default"],[64,32,39,22],[64,33,39,23,"removeItem"],[64,43,39,33],[64,44,39,34],[64,50,39,40],[64,51,39,41],[65,6,40,4],[65,12,40,10,"AsyncStorage"],[65,24,40,22],[65,25,40,22,"default"],[65,32,40,22],[65,33,40,23,"removeItem"],[65,43,40,33],[65,44,40,34],[65,57,40,47],[65,58,40,48],[66,6,42,4],[66,12,42,10,"AsyncStorage"],[66,24,42,22],[66,25,42,22,"default"],[66,32,42,22],[66,33,42,23,"setItem"],[66,40,42,30],[66,41,42,31],[66,56,42,46],[66,58,42,48,"token"],[66,63,42,53],[66,64,42,54],[67,6,43,4],[68,6,44,4,"setSuperAdmin"],[68,19,44,17],[68,20,44,18,"user"],[68,24,44,22],[68,25,44,23],[69,6,46,4],[69,13,46,11,"user"],[69,17,46,15],[70,4,47,2],[70,5,47,3],[71,4,49,2],[71,10,49,8,"logout"],[71,16,49,14],[71,19,49,17],[71,25,49,17,"logout"],[71,26,49,17],[71,31,49,29],[72,6,50,4],[72,12,50,10,"AsyncStorage"],[72,24,50,22],[72,25,50,22,"default"],[72,32,50,22],[72,33,50,23,"removeItem"],[72,43,50,33],[72,44,50,34],[72,59,50,49],[72,60,50,50],[73,6,51,4],[74,6,52,4],[74,13,52,11,"api"],[74,16,52,14],[74,17,52,14,"default"],[74,24,52,14],[74,25,52,15,"defaults"],[74,33,52,23],[74,34,52,24,"headers"],[74,41,52,31],[74,42,52,32,"common"],[74,48,52,38],[74,49,52,39],[74,64,52,54],[74,65,52,55],[75,6,53,4,"setSuperAdmin"],[75,19,53,17],[75,20,53,18],[75,24,53,22],[75,25,53,23],[76,4,54,2],[76,5,54,3],[77,4,56,2],[77,24,57,4],[77,28,57,4,"_reactJsxDevRuntime"],[77,47,57,4],[77,48,57,4,"jsxDEV"],[77,54,57,4],[77,56,57,5,"PlatformAuthContext"],[77,75,57,24],[77,76,57,25,"Provider"],[77,84,57,33],[78,6,57,34,"value"],[78,11,57,39],[78,13,57,41],[79,8,57,43,"superAdmin"],[79,18,57,53],[80,8,57,55,"loading"],[80,15,57,62],[81,8,57,64,"login"],[81,13,57,69],[82,8,57,71,"logout"],[83,6,57,78],[83,7,57,80],[84,6,57,80,"children"],[84,14,57,80],[84,16,58,7,"children"],[85,4,58,15],[86,6,58,15,"fileName"],[86,14,58,15],[86,16,58,15,"_jsxFileName"],[86,28,58,15],[87,6,58,15,"lineNumber"],[87,16,58,15],[88,6,58,15,"columnNumber"],[88,18,58,15],[89,4,58,15],[89,11,59,34],[89,12,59,35],[90,2,61,0],[91,2,61,1,"_s"],[91,4,61,1],[91,5,7,16,"PlatformAuthProvider"],[91,25,7,36],[92,2,7,36,"_c"],[92,4,7,36],[92,7,7,16,"PlatformAuthProvider"],[92,27,7,36],[93,2,63,7],[93,11,63,16,"usePlatformAuth"],[93,26,63,31,"usePlatformAuth"],[93,27,63,31],[93,29,63,34],[94,4,63,34,"_s2"],[94,7,63,34],[95,4,64,2],[95,10,64,8,"context"],[95,17,64,15],[95,20,64,18],[95,24,64,18,"useContext"],[95,30,64,28],[95,31,64,28,"useContext"],[95,41,64,28],[95,43,64,29,"PlatformAuthContext"],[95,62,64,48],[95,63,64,49],[96,4,65,2],[96,8,65,6],[96,9,65,7,"context"],[96,16,65,14],[96,18,65,16],[97,6,66,4],[97,12,66,10],[97,16,66,14,"Error"],[97,21,66,19],[97,22,66,20],[97,82,66,80],[97,83,66,81],[98,4,67,2],[99,4,68,2],[99,11,68,9,"context"],[99,18,68,16],[100,2,69,0],[101,2,69,1,"_s2"],[101,5,69,1],[101,6,63,16,"usePlatformAuth"],[101,21,63,31],[102,2,63,31],[102,6,63,31,"_c"],[102,8,63,31],[103,2,63,31,"$RefreshReg$"],[103,14,63,31],[103,15,63,31,"_c"],[103,17,63,31],[104,0,63,31],[104,3]],"functionMap":{"names":["<global>","PlatformAuthProvider","useEffect$argument_0","checkAuth","login","logout","usePlatformAuth"],"mappings":"AAA;OCM;YCI;GDE;oBEE;GFgB;gBGE;GHc;iBIE;GJK;CDO;OME;CNM"},"hasCjsExports":false},"type":"js/module"}]}